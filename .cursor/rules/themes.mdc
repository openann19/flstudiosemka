---
alwaysApply: true
---
# Theme & Design System Enforcement

- All UI code (components, styles, CSS, logic) **must** use global theme tokens and design-system variables defined in `src/styles/design-system.css` (or their TypeScript equivalents from theme management modules).
- Hardcoded colors, font-sizes, spacing, or shadows are **strictly forbidden** in component code and CSS. Use the tokens (CSS variables or theme-manager abstractions) at all layers.
- If a token is missing for a use-case, propose and add it to the design system before merging.
- Theme switching must always work by swapping design tokens (not by hot-swapping CSS files or React context hacks with direct values).
- All new styles/components must work fully with all supported themes (e.g., dark, light, high-contrast) and use only tokens, never raw values.
- All SVGs must use `currentColor` and inherit color from their parent, which should be set via theme token.
- Do **not** declare local variables for colors, spacing, etc. that copy values from tokens—refer directly to the token in code.
- Every atomic style (borders, backgrounds, text, icons, effects) must be driven by tokens; custom exceptions require design review.

# Test Enforcement

- Unit and integration tests must verify that theme changes propagate to all relevant components, e.g., by inspecting computed styles.
- Visual snapshots must be updated when tokens change.
- Fail PR if any style regression (missing token, hardcoded color) is detected.

# Example
```css
background: var(--fl-bg-dark); /* ✅ */
color: var(--fl-text-primary); /* ✅ */
box-shadow: var(--shadow-md); /* ✅ */
background: #151515; /* ❌ hardcoded, forbidden */
```
```tsx
<svg fill="currentColor" ... /> // ✅ good, theme-friendly
```

# Rationale

This ensures maintainability, theme swap compatibility, and design system consistency across all UI code.